{% extends "base.html" %}

{% block content %}
  <h1>Welcome, Administrator!</h1>

  <h2 class="mt-4">All Booked Spots</h2>
  {% if bookings %}
    <table class="table table-bordered table-hover mt-3">
      <thead class="thead-dark">
        <tr>
          <th>Slot</th>
          <th>Booked By</th>
          <th>Booking Time</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for booking in bookings %}
        <tr>
          <td>{{ booking['spot'] }}</td>
          <td>{{ booking['username'] }}</td>
          <td>{{ booking['timestamp'] }}</td>
          <td>
            <form action="{{ url_for('release_spot') }}" method="post">
              <input type="hidden" name="spot" value="{{ booking['spot'] }}">
              <button type="submit" class="btn btn-danger btn-sm">Remove Booking</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No bookings yet.</p>
  {% endif %}

  <hr>

  <h2>Manage Parking Lots</h2>

  <h4>Add New Lot</h4>
  <form action="{{ url_for('add_parking_lot') }}" method="POST" class="mb-4">
    <div class="form-group">
      <input type="text" name="name" class="form-control" placeholder="Lot Name" required>
    </div>
    <div class="form-group">
      <input type="text" name="location" class="form-control" placeholder="Location" required>
    </div>
    <div class="form-group">
      <input type="number" name="price" class="form-control" placeholder="Price (₹)" required>
    </div>
    <button type="submit" class="btn btn-success">Add Lot</button>
  </form>

  <h4>Existing Lots</h4>
  <table class="table table-bordered table-striped">
    <thead class="thead-dark">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Location</th>
        <th>Price (₹)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for lot in lots %}
      <tr>
        <td>{{ lot.id }}</td>
        <td>{{ lot.name }}</td>
        <td>{{ lot.location }}</td>
        <td>{{ lot.price }}</td>
        <td>
          <form action="{{ url_for('remove_parking_lot', lot_id=lot.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this lot?');">
            <button type="submit" class="btn btn-outline-danger btn-sm">Remove</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <br>
  <form action="{{ url_for('logout') }}" method="post">
    <button type="submit" class="btn btn-danger">Logout</button>
  </form>
  <br>
  <a href="{{ url_for('home') }}" style="color: yellow; font-weight: bold;">Back to Home</a>
{% endblock %}
